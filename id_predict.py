# -*- coding: utf-8 -*-
"""id_predict.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kN92tZXsIHy3CLOcGhCfB1Qcu4n8mp-F
"""

# id_predict.py

import pandas as pd
from keras.models import load_model
from sklearn.preprocessing import MinMaxScaler, pickle

# Load scaler
scaler = pickle.load(open('scaler.pkl','rb'))

# Load model
model = load_model('model.h5')

# Preprocessing functions
def encode_categorical(df):
  df = pd.get_dummies(df, drop_first=True)
  return df

def normalize(data):
  return scaler.transform(data)

def preprocess(data):
  data = pd.DataFrame(data)
  data = encode_categorical(data)
  data = normalize(data)
  return data

def predict(inputs):

  # Preprocess
  inputs = preprocess(inputs)

  # Predict
  prediction = model.predict(inputs).flatten()

  return prediction

if __name__ == '__main__':

  # Example input
  inputs = [1.2, 0.5, 27, 0.1, 'tt']

  # Columns order
  cols = ['vds', 'L(um)', 'W(um)', 'drain_length(um)', 'temperature',	'vgs', 'vsb' ,'corner']

  # Predict
  predicted_id = predict(inputs)

  print("Predicted Id: ", predicted_id)